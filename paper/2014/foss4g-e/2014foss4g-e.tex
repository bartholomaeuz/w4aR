% This is "sig-alternate.tex" V2.0 May 2012
% This file should be compiled with V2.5 of "sig-alternate.cls" May 2012
%
% This example file demonstrates the use of the 'sig-alternate.cls'
% V2.5 LaTeX2e document class file. It is for those submitting
% articles to ACM Conference Proceedings WHO DO NOT WISH TO
% STRICTLY ADHERE TO THE SIGS (PUBS-BOARD-ENDORSED) STYLE.
% The 'sig-alternate.cls' file will produce a similar-looking,
% albeit, 'tighter' paper resulting in, invariably, fewer pages.
%
% ----------------------------------------------------------------------------------------------------------------
% This .tex file (and associated .cls V2.5) produces:
%       1) The Permission Statement
%       2) The Conference (location) Info information
%       3) The Copyright Line with ACM data
%       4) NO page numbers
%
% as against the acm_proc_article-sp.cls file which
% DOES NOT produce 1) thru' 3) above.
%
% Using 'sig-alternate.cls' you have control, however, from within
% the source .tex file, over both the CopyrightYear
% (defaulted to 200X) and the ACM Copyright Data
% (defaulted to X-XXXXX-XX-X/XX/XX).
% e.g.
% \CopyrightYear{2007} will cause 2007 to appear in the copyright line.
% \crdata{0-12345-67-8/90/12} will cause 0-12345-67-8/90/12 to appear in the copyright line.
%
% ---------------------------------------------------------------------------------------------------------------
% This .tex source is an example which *does* use
% the .bib file (from which the .bbl file % is produced).
% REMEMBER HOWEVER: After having produced the .bbl file,
% and prior to final submission, you *NEED* to 'insert'
% your .bbl file into your source .tex file so as to provide
% ONE 'self-contained' source file.
%
% ================= IF YOU HAVE QUESTIONS =======================
% Questions regarding the SIGS styles, SIGS policies and
% procedures, Conferences etc. should be sent to
% Adrienne Griscti (griscti@acm.org)
%
% Technical questions _only_ to
% Gerald Murray (murray@hq.acm.org)
% ===============================================================
%
% For tracking purposes - this is V2.0 - May 2012

\documentclass{sig-alternate}

\usepackage{listings}

\begin{document}
%
% --- Author Metadata here ---
\conferenceinfo{Foss4g Europe}{'14 Bremen, Germany}
% --- End of Author Metadata ---

\title{Comparison of Open Source routing services with OpenStreetMap Data for blind pedestrians}
\subtitle{PgRouting, OpenTripPlanner and OpenSourceRoutingMaschine}

\numberofauthors{3} 

\author{
% 1st. author
\alignauthor Markus Dornhofer\\
       \affaddr{FH JOANNEUM}\\
       \affaddr{Energy and Transportation}\\
       \affaddr{Kapfenberg - Austria}\\
       \email{markus.dornhofer @fh-joanneum.at}
% 2th. author
\alignauthor Werner Bischof\\
       \affaddr{FH JOANNEUM}\\
       \affaddr{Energy and Transportation}\\
       \affaddr{Kapfenberg - Austria}\\
       \email{werner.bischof @fh-joanneum.at}
% 3th. author
\alignauthor Elmar Krajnc\\
       \affaddr{FH JOANNEUM}\\
       \affaddr{Internet Technology}\\
       \affaddr{Kapfenberg - Austria}\\
       \email{elmar.krajnc @fh-joanneum.at}
}

\maketitle

\begin{abstract}
Today's smartphones are more than just a telephone. With built-in positions sensors a phone can be used as a personal navigation device. Even blind or visual impaired people are used to modern phones. With assisted technologies like VoiceOver or Talkback, blind people are not reliant on phones with haptic/touchable keys. A lot of effort was made to improve the positioning indoor and outdoors, but affordable technologies are not accurate enough to navigate blind persons on a safe trip. The positioning should be improved by telling the user the surrounding environment. In example the user can verify the position of the sidewalk by telling him the location of the street and the buildings. The goal is the selection of a routing maschine which can deliver a safe route and additional trip information (i.e. crossings with acoustic traffic lights). 
\end{abstract}

\keywords{GIS, Routing, Navigation, Blind, Pedestrian}

\section{Introduction}
For visually impaired and blind people the fastest or the shortest route is not the important fact, they prefer the safest route from a start point to an end point (In figure \ref{fig:sd} there are also other user-groups, which prefer specialized routing). There are some navigation systems for blind users available on the market, but no system makes much use of additional data for blind users. 
OpenStreetMap contains very useful information for visually impaired and blind people. It make it possible to find a safe route from a start point to an end point, which includes acoustical traffic signals and safe sidewalks. Also additional information can be used for navigation. If the user is told that the building is on the right hand side, he/she can verify the information and improve the positioning. If there is a dangerous situation(i.e. the proximity of a waste basket, a poller or a hydrant) a warning should occur. \\ 
Today there are some mature open source routing engines available. Many of them focus on car navigation, bicycle navigation and pedestrian navigation. Some of them even include multi-modal routing in combination with public transportation systems. In this paper a comparison between different open source routing engines (PgRouting,OpenTripPlanner and OpenSourceRoutingMachine) is made. Is it possible to transfer the technology from car navigation to blind pedestrian navigation?

\begin{figure}
\centering
\includegraphics[width=3in]{PONS-Routing-Overview.png}
\caption{Specialized routing}
\label{fig:pons}
\end{figure}

\section{User Requirements}
The navigation device should be a smartphone. The user group often has less money and could not afford additional devices. The user interface on the smartphone should be barrier free and useable for blind and visually impaired people. During the navigation process the hands should be free for the blindman stick an additional stuff. The user should feel less disturbance and the surrounding traffic and the enviroment should be recognisable.  

\section{Related Work in blind pedestrian routing and navigation}
The pioneer in free GPS navigation software is Loadstone GPS\cite{loadstone}. It is running on Symbian mobile phones and uses an external bluetooth GPS receiver. The product is very popular in the community of blind and visually impaired people. Nevertheless there is no active development anymore. \\
On the iOS platform Blindsquare\cite{blindsquare} is a very popolar App. It uses point of interest information from foursquare and OpenStreetMap and allow navigation to the PointOfInterests. The actual price is about 24 US Dollar. \\
OsmAnd (OSM Automated Navigation Directions) is a map and navigation application with OpenStreetMap (OSM) data. All map data can be stored on your device's memory card for offline use. Via your device's GPS, OsmAnd offers routing, with optical and voice guidance, for car, bike, and pedestrian. It has a Turn-by-turn voice guidance and does an automatic re-routing whenever you deviate from the route. OsmAnd works well for blind people with Talkback when the uses pre stored favourites. The greatest challenge for the blind people is the destination input, which is only possible with standard keyboard.  \\
'Ready.Set.Access'\cite{weyrer} is a master thesis about intermodal door-to-door application for people with disabilities. The implementation was done with the OpenTripPlanner (section \ref{subsec:otp}) Routing Software. It combines indoor and outdoor navigation. The main focus is on wheelchair accessibility. The project also analyses the topography of a region and flat slops are preferred. In the thesis a geospatial barrier catalogue with six categories (Way Types, Surface Types, Way Related Attribues, Node Information, General Attributes and Public Transport) was made. \\
Sven Leitinger\cite{sven:osm} from Salzburg Research wrote a guideline to enhance the OSM Data with blind related attributes. He explained most of the OSM tag, which are useful for blind people. \\
The scientific paper\cite{Volkel:2008} RouteCheckR focus on route finding for mobility impaired people. A safety factor was embedded in the route calculation. It is recommended to read this paper, if you are interested in routing algorithms with includes safety parameters. The algorithms itself are not scope of this work.  

\section{OpenStreetMap (OSM)}
OpenSteetMap was founded in the year 2004. In this last 10 years a enormous map material was generated by volunteers. The map data is free available without any licence cost. Therefore a lot of open source routing tools work with OSM data. \\
The map network consist of nodes and ways like a routing graph with special attributes called map features. There are confirmed map features and proposed map features.  Both will be used in the routing process to find the safest route. It is not scope of the project to find new OSM features for blind pedestrians.   

\subsection{Interesting features for blind people}
Some of the main attributes for blind pedestrians. The information should be given to the users during the navigation.
\begin{itemize}
  \item highway=pedestrian,living\_street,path, \\ footway,steps,elevator
  \item surface=paved,unpaved,asphalt,concrete,concrete:plates, \\ fine\_gravel,metal,paving\_stones
  \item footway=sidewalk,kerb,tactile\_paving
  \item crossing=taffic\_signals:sound  
\end{itemize}

\section{Routing Problem}
The main task of an ordinary routing system is to find the shortest route or the fastest route. In blind person routing also safety plays a important  role. In general those five requirements\cite{weyrer} are needed to do navigation and routing.
\begin{enumerate}
  \item A procedure to set start point and end point
  \item A connected network (routing graph), on which the routing can be performed
  \item An algorithm that computes the route between start point and end point
  \item The inclusion of user requirements in the route computation and selection
  \item The presentation of the results to the use
\end{enumerate}

This work focus most on point 4 of the list. The influence of the user requirements on the route.  

\section{Prerequisites}
Following questions has to be asked to choose the right routing service for the comparison.\\
Is the routing service free of charge and is it possible to adopt it for blind pedestrian routing? Is it possible to put additional information in the routing graph? Can OpenStreetMap data be used to generate the routing graph? What hardware is needed to run the routing server? A Web-Frontend is not required for the blind users, but it is important for the developer. It is easier to test different routes and it gives you a good impression about the output of the routing service. 
\section{Comparison between different routing tools}
In a first selection three tools has been found, which fulfil the requirements. For sure there are more tools around, but these three are well documented and active.
\begin{itemize}
  \item PgRouting
  \item OpenTripPlanner
  \item OpenSourceRoutingMachine  
\end{itemize}

  
\subsection{Generation of the routing graph}

All routing services in this comparison use OpenStreetMap data to generate the routing graph. It is important that the routing graph has all the OpenStreetMap attributes, which are important for blind people. The process is illustrated in Figure \ref{fig:overview}.

\begin{figure}
\centering
\includegraphics[width=3in]{Overview2.png}
\caption{Overview}
\label{fig:overview}
\end{figure}


\subsection{pgRouting}
pgRouting\cite{pgrouting} is an extension to the PostGIS standard. PostGIS brings spatial information to Postgres database. In a well documented workshop from pgRouting the combination of Geoserver and OpenLayers is shown. Also a example with QGIS is included. \\
It is easy to get a GeoJson track with  some server side programming language (i.e. PHP or Perl). So even interfaces to smartphone applications should be manageable. But the lack of turn instructions makes the difference to other routing tools.  

\begin{description}
  \item[+] routing network or route can be displayed with GIS software (i.e. QGIS)
  \item[+] many different routing algorithms (Dijkstra, A-Star and Shooting Star)  are implemented
  \item[+] standardised routing graph (PostGIS)
  \item[+] data is easy accessible
  \item[-] a lot of components (Postgres, PostGIS, osm2pgrouting, GeoServer, OpenLayers) from different vendors   
  \item[-] difficult to set up the environment 
  \item[-] no turn instructions implemented
  \item[-] no mature Web-Frontend  
\end{description} 

The OSM data can be transferred to Postgres database by the program osm2pgrouting. Priorities of roads can be set in a Xml configuration file (Listing \ref{lst:pgr}).

\lstinputlisting[language=Xml,basicstyle=\footnotesize,breaklines=true,frame=lines,caption={osm2pgrouting Mapconfig.xml},label={lst:pgr}]{mapconfig_for_cars.xml}

\subsection{OpenTripPlaner (OTP)}
\label{subsec:otp}
 
The OpenTripPlaner servlet runs on a Java web server. It is a complete bundle which includes a Rest Api and a Web-Frontend(Figure \ref{fig:otp}). Over  the Web-Frontend a start and an end point can be set and with a button click the route can be requested. To Drag-and-Drop the markers as with the OSRM Web-Frontend is not possible. The route request takes much more time as with OSRM. For other Applications like smartphone applications there is a well dokumentated Rest Api, where a route can be requested with many parameters. There is already a open source Android application interacting with the routing server. But with no user interface for blind people. \\
One routing process can handle multiple profiles (i.e. Walking, Bicycle and Car) and intermodal transportation. GTFS (General Transit Feed Specification) format from Google is used to query the timetables from public transportation companies. 

\begin{description}
  \item[+] includes public transportation ( GTFS)
  \item[+] intermodal (i.e. combine walk and public transport) trips
  \item[+] well documented Rest Api
  \item[+] separated Java web-apps (Web-Frontend and routing service)
  \item[+] less dependencies (any Java web server)
  \item[+] multiple profiles (Bike, walk, transit) handled by a single routing process
  \item[+] walk speed selectable
  \item[+] safety options in the configure file available
  \item[+] easy configuration with Xml file
  \item[+] Logging and Debugging 
  \item[+] open source Android application
  \item[-] slow route calculation
  \item[-] need much resources to build routing graph   
\end{description} 
 
\begin{figure}
\centering
\includegraphics[width=3in]{otp-ss.png}
\caption{Screenshot OTP - Kapfenberg}
\label{fig:otp}
\end{figure}
 
 The graph builder is controlled by an XML (Listing \ref{lst:otp}) configuration. For medium regions (i.e. the Country Austria) a lot of RAM is needed. OpenTripPlanner is intended for small and medium geographic areas, but with huge amount of RAM also big areas are possible. The safety parameter was invented for bicycles. There can be a notification, if the osm key surface  has a specific value (i.e. 'Caution: muddy!'). The safety value of 1 is default. Very safe streets can have a value below 1 and for dangerous streets a value more than 1 can be given. The distance of a street segment will be multiplied with the safe value. A ten times more dangerous street will have the the length of the street times 10. \\
 With a permission key all transportation types (i.e. Pedestrian, Bicycle, ..) can be put on a white list. So street segment can be accessed by this type of transportation. \\
 It should be possible to convert the bicycle safety features to pedestrian safety features.
 
\lstinputlisting[language=Xml,basicstyle=\footnotesize,breaklines=true,frame=lines,caption={OTP GraphBuilder.xml},label={lst:otp}]{otp-config.xml}


\subsection{OpenSourceRoutingMachine (OSRM)}
The project is separated in the routing service and a Web-Frontend(Figure \ref{fig:osrm}). The routing service is written in C++ and needs less hardware resources then OpenTripPlanner. The routing graph can be influenced by a profile configuration. The profile is a lua script file. So even more sophisticated configurations can be done, but it is more complex as a Xml configuration file. In the standard configuration no safety properties are in the profile file. The route can be influenced by the speed parameter, so a safe street can have a higher speed value. For sure this will also change the travel time. For every profile a single instance of the routing machine is needed.  \\
\begin{description}
\item[+]very fast\cite{luxen-vetter-2011}, need less resources
\item[+]lua script language to configure the routing graph 
\item[+]shortest path calculation contraction hierarchies, faster then dijskta algorithm
\item[+]blacklist of street, which should not be used
\item[+]delivers Gpx track or turn instruction list in Json
\item[+]nice Web-Frontend
\item[+]supports multiple targets in the route request
\item[-]no safety properties available
\end{description}

\begin{figure}
\centering
\includegraphics[width=3in]{osrm-ss.png}
\caption{Screenshot OSRM - Kapfenberg}
\label{fig:osrm}
\end{figure}

The route can be configured for blind pedestrians, but there will be no turn instruction if the road name/type stays the same. So even on an orthogonal crossing there can be no turn instruction, if the road stays the same. 
The missing turn instruction can be found on Figure \ref{fig:osrm}. There is only one turn instructions, instead of two. The same problem occour in the OpenTripPlaner (Figure \ref{fig:otp}).\\
The route response is well documented. It delivers all track points and for some track points a turn instruction. Some example turn instructions can be found on Table \ref{tab:rlist}. \\
The route request is handled by a Plug-in. New features can also be added by a Plug-in.

 

\begin{table}
\centering
\caption{Example Routing List}
\begin{tabular}{|c|c|c|c|c|} \hline
No&Turn Angle&Road Name/Type&Distance&Heading\\ \hline \hline
4&282&Werk-VI-Strasse&250m&NW\\ \hline
12&14&Path&24m&SW\\ \hline
\end{tabular}
\label{tab:rlist}
\end{table}

In the profile settings (Listing \ref{lst:osrm}) different speeds for all kind of roads can be set. Additional OSM meta data can be delivered in the road name/type field. On every different road name/type a turn instruction is triggered. 


\lstinputlisting[basicstyle=\footnotesize,breaklines=true,frame=lines,caption={OSRM profile.lua},label={lst:osrm}]{foot-osrm.lua}

\section{System Design}

\begin{figure}
\centering
\includegraphics[width=3in]{System-Design2.png}
\caption{System Design}
\label{fig:sd}
\end{figure}
The system was designed as Server/Client Infrastructure (Figure \ref{fig:sd}). The network graph is held on the server and the routing calculation is also done on the server.  The client ask for the best route from start point to a destination point. Even multiple destination can be handled by the server. Then the server replies with a Json formated file. The Json file contains the Gpx Track and all turn instructions. The turn instructions contain the turn angle, the street name or road type, the distance to the next turn instruction and the heading information (Table \ref{tab:rlist}). A network connection is needed for every route request. 

\section{First Results and Tests}
The Android application development started at the same time as the comparison between the different routing machines. It was clear that the Application request a route with a start and a stop position and the server replies with a well structured (i.e. Xml or Json) format. \\
The user interface and the navigation instructions are much more important on the smartphone. The routing server should be replaceable by any routing service in the comparison. By the way OSRM was chosen as routing service for the first test. On the Application side a target position can be selected from a list and the actual position was used as start position. After the routing request, the response is displayed in a new list (Figure ~\ref{fig:app}). \\
The user can explore the whole trip on the screen. Turn instruction by turn instruction. The distance to the next crossing point is spoken periodically. If the proximity of the crossing point was reached the turn instruction was told. \\


\begin{figure}
\centering
\includegraphics[width=2.5in]{App2.png}
\caption{Android App}
\label{fig:app}
\end{figure}


\section{Conclusion}

All three software products can be adopted for blind pedestrian routing, but the implementations differ a lot. So a question can be which programming language (Java, C++ or SQL) is your favourite. The main focus of every implementation is unique and the systems differ a lot. \\ 
OpenTripPlaner is the only Software with a safety parameter and has the most features. On the other hand the package needs a huge amount of resources. \\
 OpenSourceRoutingMaschine performs very good and supports flexible configuration options. But to make use of all the function a good knowledge of the software structure is needed. \\
 PgRouting use a standardized road network (Postgis) and has more focus on different routing algorithms. A lot of software development will be needed to implement the missing functions.


\section{Future work}
The first version was just a prove of concept. The main focus was on the user interface on the smartphone side and on a stable server and client communication. The navigation has to be improved a lot. There has to be a mode where blind people can follow a track in a park without much orientation kerbs. Also a module is needed to get information about the near environment (i.e. Position of the road and the buildings). This information could not be found in the route and has to queried frome the data source itself. There have to be turn instructions where the road name/type stays the same, but makes a curve (i.e. priority roads). And an evaluation of the priority of foot ways has to be done. 

%
% The following two commands are all you need in the
% initial runs of your .tex file to
% produce the bibliography for the citations in your paper.
\bibliographystyle{abbrv}
\bibliography{sigproc}  % sigproc.bib is the name of the Bibliography in this case
% You must have a proper ".bib" file
%  and remember to run:
% latex bibtex latex latex
% to resolve all references
%
% ACM needs 'a single self-contained file'!
%
%APPENDICES are optional
%\balancecolumns

\end{document}
